<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RestaurantPOS v2.4 - Sistema Profesional</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <style>
        /* Prevenir zoom en iOS */
        input, select, textarea {
            font-size: 16px !important;
        }
        
        /* Estilos para impresi√≥n t√©rmica */
        @media print {
            @page {
                size: 80mm auto;
                margin: 0;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .no-print {
                display: none !important;
            }
            .thermal-receipt {
                width: 80mm !important;
                font-family: 'Courier New', monospace !important;
                font-size: 12px !important;
                padding: 5mm !important;
                margin: 0 !important;
            }
        }
        
        .thermal-receipt {
            width: 80mm;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            padding: 20px;
            margin: 0 auto;
            background: white;
        }
        
        /* Estilos adicionales para mejor visualizaci√≥n */
        .logo-container {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .logo-image {
            max-height: 60px;
            max-width: 120px;
            object-fit: contain;
        }
        
        .logo-emoji {
            font-size: 2.5rem;
            line-height: 1;
        }
        
        /* Scroll personalizado */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Grid de emojis responsive */
        .emoji-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 6px;
        }
        
        @media (min-width: 640px) {
            .emoji-grid {
                grid-template-columns: repeat(8, 1fr);
                gap: 8px;
            }
        }
        
        .emoji-button {
            font-size: 1.25rem;
            width: 100%;
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.2s;
            cursor: pointer;
            min-height: 40px;
        }
        
        @media (min-width: 640px) {
            .emoji-button {
                font-size: 1.5rem;
            }
        }
        
        .emoji-button:hover {
            transform: scale(1.1);
            background-color: #f3f4f6;
        }
        
        .emoji-button.selected {
            background-color: #fed7aa;
            border: 2px solid #f97316;
            transform: scale(1.1);
        }
        
        /* Animaci√≥n suave para la hora */
        @keyframes fadeIn {
            from { opacity: 0.8; transform: translateY(-2px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .time-update {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* Estilo para la hora grande */
        .big-time {
            font-family: 'Courier New', monospace;
            letter-spacing: 2px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        /* Mejoras m√≥viles */
        @media (max-width: 640px) {
            .touch-target {
                min-height: 44px;
                min-width: 44px;
            }
            
            .mobile-compact {
                padding: 0.5rem !important;
            }
            
            .mobile-stack {
                display: flex;
                flex-direction: column;
            }
            
            .mobile-text-sm {
                font-size: 0.875rem;
            }
            
            .mobile-hidden {
                display: none;
            }
        }
        
        .product-grid {
            display: grid;
            gap: 0.75rem;
            grid-template-columns: repeat(2, 1fr);
        }
        
        @media (min-width: 640px) {
            .product-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 1rem;
            }
        }
        
        @media (min-width: 1024px) {
            .product-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        .modal-content {
            max-height: 90vh;
            overflow-y: auto;
        }
        
        @media (max-width: 640px) {
            .modal-content {
                max-height: 85vh;
                margin: 0.5rem;
            }
        }
        
        input[type="number"],
        input[type="text"],
        select {
            -webkit-appearance: none;
            appearance: none;
            border-radius: 8px;
        }
        
        .btn-touch {
            padding: 0.75rem 1rem;
            font-weight: 600;
            border-radius: 0.5rem;
            transition: all 0.2s;
        }
        
        @media (max-width: 640px) {
            .btn-touch {
                padding: 0.875rem 1rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // Iconos actualizados (mantener los mismos)
        const ShoppingCart = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="9" cy="21" r="1"></circle>
                <circle cx="20" cy="21" r="1"></circle>
                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
        );

        const TrendingUp = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const Package = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M16.5 9.4 7.55 4.24"></path>
                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                <line x1="12" y1="22.08" x2="12" y2="12"></line>
            </svg>
        );

        const Settings = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
                <circle cx="12" cy="12" r="3"></circle>
            </svg>
        );

        const LogOut = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        );

        const Trash = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        );

        const Plus = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Minus = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Edit = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
            </svg>
        );

        const X = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Check = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="20 6 9 17 4 12"></polyline>
            </svg>
        );

        const Clock = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Calendar = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Printer = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="6 9 6 2 18 2 18 9"></polyline>
                <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path>
                <rect x="6" y="14" width="12" height="8"></rect>
            </svg>
        );

        const ChevronDown = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
        );

        const DollarSign = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const Upload = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="17 8 12 3 7 8"></polyline>
                <line x1="12" y1="3" x2="12" y2="15"></line>
            </svg>
        );

        const Download = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        const Users = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
            </svg>
        );

        const Tag = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path>
                <line x1="7" y1="7" x2="7.01" y2="7"></line>
            </svg>
        );

        const RestaurantApp = () => {
          const [currentView, setCurrentView] = useState('login');
          const [products, setProducts] = useState([]);
          const [sales, setSales] = useState([]);
          const [categories, setCategories] = useState(['Comida', 'Bebida', 'Postre', 'Entrada']);
          const [cart, setCart] = useState([]);
          const [selectedCategory, setSelectedCategory] = useState('Todas');
          const [showAddProduct, setShowAddProduct] = useState(false);
          const [showPaymentModal, setShowPaymentModal] = useState(false);
          const [paymentMethod, setPaymentMethod] = useState('cash');
          const [cashAmount, setCashAmount] = useState('');
          const [transferAmount, setTransferAmount] = useState('');
          const [editingProduct, setEditingProduct] = useState(null);
          const [showReceipt, setShowReceipt] = useState(false);
          const [lastSale, setLastSale] = useState(null);
          const [currentTime, setCurrentTime] = useState(new Date());
          const [searchTerm, setSearchTerm] = useState('');
          const [dateFilter, setDateFilter] = useState('today');
          const [selectedDate, setSelectedDate] = useState(new Date().toISOString().split('T')[0]);
          
          const [businessName, setBusinessName] = useState('Mi Restaurante');
          const [businessLogo, setBusinessLogo] = useState('üçΩÔ∏è');
          const [logoType, setLogoType] = useState('emoji');
          const [showEmojiPicker, setShowEmojiPicker] = useState(false);

          // Nuevos estados para usuarios
          const [users, setUsers] = useState([
            { id: 1, username: 'admin', password: 'admin', role: 'admin', name: 'Administrador' },
            { id: 2, username: 'cajero', password: 'cajero', role: 'cashier', name: 'Cajero' }
          ]);
          const [currentUser, setCurrentUser] = useState(null);
          const [showUserManagement, setShowUserManagement] = useState(false);
          const [editingUser, setEditingUser] = useState(null);
          const [newUser, setNewUser] = useState({
            username: '',
            password: '',
            role: 'cashier',
            name: ''
          });

          // Nuevos estados para categor√≠as
          const [showCategoryManagement, setShowCategoryManagement] = useState(false);
          const [editingCategory, setEditingCategory] = useState(null);
          const [newCategory, setNewCategory] = useState('');

          const [newProduct, setNewProduct] = useState({
            name: '',
            price: '',
            category: 'Comida',
            stock: '',
            image: '',
            description: ''
          });

          const [username, setUsername] = useState('');
          const [password, setPassword] = useState('');
          const [isLoggedIn, setIsLoggedIn] = useState(false);

          const emojis = [
            'üçΩÔ∏è', 'üçï', 'üçî', 'üçó', 'üåÆ', 'üçú', 'üç±', 'üçõ',
            'üçù', 'ü•ò', 'üç≥', 'ü•ó', 'üåØ', 'ü•ô', 'üçñ', 'ü•©',
            'üç§', 'ü¶û', 'üç£', 'üç±', 'üç≤', 'ü•ü', 'üç¢', 'üç°',
            'üßÅ', 'üç∞', 'üéÇ', 'üçÆ', 'üç≠', 'üç¨', 'üç´', 'üçø',
            'üç©', 'üç™', '‚òï', 'üçµ', 'ü•§', 'üçπ', 'üç∏', 'üç∫',
            'üçª', 'ü•Ç', 'üç∑', 'ü•É', 'üçæ', 'üßÉ', 'üßã', 'ü•õ',
            'üè™', 'üè¨', 'üè¢', 'üç¥', 'ü•Ñ', 'üî™', 'ü•¢', 'üç∂',
            'üéä', 'üéâ', '‚≠ê', 'üíé', 'üë®‚Äçüç≥', 'üë©‚Äçüç≥', 'üßë‚Äçüç≥', 'üéØ'
          ];

          useEffect(() => {
            const timer = setInterval(() => {
              setCurrentTime(new Date());
            }, 1000);
            return () => clearInterval(timer);
          }, []);

          useEffect(() => {
            const savedProducts = localStorage.getItem('restaurantProducts');
            const savedSales = localStorage.getItem('restaurantSales');
            const savedBusinessName = localStorage.getItem('businessName');
            const savedBusinessLogo = localStorage.getItem('businessLogo');
            const savedLogoType = localStorage.getItem('logoType');
            const savedCategories = localStorage.getItem('restaurantCategories');
            const savedUsers = localStorage.getItem('restaurantUsers');

            if (savedProducts) setProducts(JSON.parse(savedProducts));
            if (savedSales) setSales(JSON.parse(savedSales));
            if (savedBusinessName) setBusinessName(savedBusinessName);
            if (savedBusinessLogo) setBusinessLogo(savedBusinessLogo);
            if (savedLogoType) setLogoType(savedLogoType);
            if (savedCategories) setCategories(JSON.parse(savedCategories));
            if (savedUsers) setUsers(JSON.parse(savedUsers));
          }, []);

          useEffect(() => {
            localStorage.setItem('restaurantProducts', JSON.stringify(products));
          }, [products]);

          useEffect(() => {
            localStorage.setItem('restaurantSales', JSON.stringify(sales));
          }, [sales]);

          useEffect(() => {
            localStorage.setItem('businessName', businessName);
          }, [businessName]);

          useEffect(() => {
            localStorage.setItem('businessLogo', businessLogo);
          }, [businessLogo]);

          useEffect(() => {
            localStorage.setItem('logoType', logoType);
          }, [logoType]);

          useEffect(() => {
            localStorage.setItem('restaurantCategories', JSON.stringify(categories));
          }, [categories]);

          useEffect(() => {
            localStorage.setItem('restaurantUsers', JSON.stringify(users));
          }, [users]);

          // Impresi√≥n autom√°tica
          useEffect(() => {
            if (showReceipt && lastSale) {
              // Peque√±o delay para asegurar que el DOM est√© listo
              setTimeout(() => {
                window.print();
              }, 100);
            }
          }, [showReceipt, lastSale]);

          const handleLogin = (e) => {
            e.preventDefault();
            const user = users.find(u => u.username === username && u.password === password);
            if (user) {
              setIsLoggedIn(true);
              setCurrentUser(user);
              // Redirigir seg√∫n rol
              if (user.role === 'admin') {
                setCurrentView('sales');
              } else {
                setCurrentView('sales'); // Los cajeros solo ven ventas
              }
            } else {
              alert('Usuario o contrase√±a incorrectos');
            }
          };

          const handleLogout = () => {
            setIsLoggedIn(false);
            setCurrentUser(null);
            setCurrentView('login');
            setUsername('');
            setPassword('');
            setCart([]);
          };

          const addUser = (e) => {
            e.preventDefault();
            if (editingUser) {
              setUsers(users.map(u => 
                u.id === editingUser.id 
                  ? { ...newUser, id: u.id }
                  : u
              ));
              setEditingUser(null);
            } else {
              const user = {
                ...newUser,
                id: Date.now()
              };
              setUsers([...users, user]);
            }
            setNewUser({
              username: '',
              password: '',
              role: 'cashier',
              name: ''
            });
            setShowUserManagement(false);
          };

          const deleteUser = (id) => {
            if (id === currentUser?.id) {
              alert('No puedes eliminar tu propio usuario');
              return;
            }
            if (window.confirm('¬øEst√°s seguro de eliminar este usuario?')) {
              setUsers(users.filter(u => u.id !== id));
            }
          };

          const editUser = (user) => {
            setEditingUser(user);
            setNewUser(user);
            setShowUserManagement(true);
          };

          const addCategory = (e) => {
            e.preventDefault();
            if (newCategory.trim()) {
              if (editingCategory) {
                const index = categories.indexOf(editingCategory);
                if (index !== -1) {
                  const updatedCategories = [...categories];
                  updatedCategories[index] = newCategory;
                  setCategories(updatedCategories);
                  
                  // Actualizar productos con la categor√≠a anterior
                  setProducts(products.map(p => 
                    p.category === editingCategory 
                      ? { ...p, category: newCategory }
                      : p
                  ));
                }
                setEditingCategory(null);
              } else {
                if (!categories.includes(newCategory)) {
                  setCategories([...categories, newCategory]);
                }
              }
              setNewCategory('');
              setShowCategoryManagement(false);
            }
          };

          const deleteCategory = (category) => {
            if (window.confirm(`¬øEst√°s seguro de eliminar la categor√≠a "${category}"? Los productos con esta categor√≠a se mover√°n a "Comida"`)) {
              setCategories(categories.filter(c => c !== category));
              setProducts(products.map(p => 
                p.category === category 
                  ? { ...p, category: 'Comida' }
                  : p
              ));
            }
          };

          const editCategory = (category) => {
            setEditingCategory(category);
            setNewCategory(category);
            setShowCategoryManagement(true);
          };

          const formatTime = (date) => {
            return date.toLocaleTimeString('es-ES', { 
              hour: '2-digit', 
              minute: '2-digit',
              second: '2-digit',
              hour12: false
            });
          };

          const formatDate = (date) => {
            return date.toLocaleDateString('es-ES', { 
              weekday: 'long',
              year: 'numeric',
              month: 'long',
              day: 'numeric'
            });
          };

          const addProduct = (e) => {
            e.preventDefault();
            if (editingProduct) {
              setProducts(products.map(p => 
                p.id === editingProduct.id 
                  ? { ...newProduct, id: p.id, price: parseFloat(newProduct.price), stock: parseInt(newProduct.stock) }
                  : p
              ));
              setEditingProduct(null);
            } else {
              const product = {
                ...newProduct,
                id: Date.now(),
                price: parseFloat(newProduct.price),
                stock: parseInt(newProduct.stock)
              };
              setProducts([...products, product]);
            }
            setNewProduct({
              name: '',
              price: '',
              category: 'Comida',
              stock: '',
              image: '',
              description: ''
            });
            setShowAddProduct(false);
          };

          const deleteProduct = (id) => {
            if (window.confirm('¬øEst√°s seguro de eliminar este producto?')) {
              setProducts(products.filter(p => p.id !== id));
            }
          };

          const editProduct = (product) => {
            setEditingProduct(product);
            setNewProduct(product);
            setShowAddProduct(true);
          };

          const addToCart = (product) => {
            const existingItem = cart.find(item => item.id === product.id);
            if (existingItem) {
              if (existingItem.quantity < product.stock) {
                setCart(cart.map(item =>
                  item.id === product.id
                    ? { ...item, quantity: item.quantity + 1 }
                    : item
                ));
              } else {
                alert('No hay suficiente stock');
              }
            } else {
              if (product.stock > 0) {
                setCart([...cart, { ...product, quantity: 1 }]);
              } else {
                alert('Producto sin stock');
              }
            }
          };

          const removeFromCart = (id) => {
            setCart(cart.filter(item => item.id !== id));
          };

          const updateQuantity = (id, change) => {
            setCart(cart.map(item => {
              if (item.id === id) {
                const newQuantity = item.quantity + change;
                if (newQuantity > 0 && newQuantity <= item.stock) {
                  return { ...item, quantity: newQuantity };
                }
              }
              return item;
            }));
          };

          const getTotal = () => {
            return cart.reduce((sum, item) => sum + (item.price * item.quantity), 0).toFixed(2);
          };

          const processSale = (e) => {
            e.preventDefault();

            const total = parseFloat(getTotal());
            let isValid = false;

            if (paymentMethod === 'cash') {
              const cash = parseFloat(cashAmount);
              if (cash >= total) {
                isValid = true;
              } else {
                alert('El monto recibido es insuficiente');
                return;
              }
            } else if (paymentMethod === 'transfer') {
              isValid = true;
            } else if (paymentMethod === 'mixed') {
              const cash = parseFloat(cashAmount || 0);
              const transfer = parseFloat(transferAmount || 0);
              if (Math.abs((cash + transfer) - total) < 0.01) {
                isValid = true;
              } else {
                alert('La suma de efectivo y transferencia debe ser igual al total');
                return;
              }
            }

            if (isValid) {
              const sale = {
                id: Date.now(),
                items: cart,
                total: total,
                paymentMethod,
                cashAmount: paymentMethod === 'cash' || paymentMethod === 'mixed' ? parseFloat(cashAmount || 0) : 0,
                transferAmount: paymentMethod === 'transfer' ? total : (paymentMethod === 'mixed' ? parseFloat(transferAmount || 0) : 0),
                change: paymentMethod === 'cash' ? (parseFloat(cashAmount) - total).toFixed(2) : 0,
                date: new Date().toISOString(),
                time: formatTime(new Date()),
                cashier: currentUser?.name || 'Cajero'
              };

              cart.forEach(item => {
                setProducts(products.map(p =>
                  p.id === item.id
                    ? { ...p, stock: p.stock - item.quantity }
                    : p
                ));
              });

              setSales([...sales, sale]);
              setLastSale(sale);
              setCart([]);
              setShowPaymentModal(false);
              setPaymentMethod('cash');
              setCashAmount('');
              setTransferAmount('');
              setShowReceipt(true);
            }
          };

          const printReceipt = () => {
            window.print();
          };

          const filteredProducts = products.filter(product => {
            const matchesCategory = selectedCategory === 'Todas' || product.category === selectedCategory;
            const matchesSearch = product.name.toLowerCase().includes(searchTerm.toLowerCase());
            return matchesCategory && matchesSearch;
          });

          const getFilteredSales = () => {
            return sales.filter(sale => {
              const saleDate = new Date(sale.date);
              const today = new Date();
              
              if (dateFilter === 'today') {
                return saleDate.toDateString() === today.toDateString();
              } else if (dateFilter === 'week') {
                const weekAgo = new Date(today);
                weekAgo.setDate(today.getDate() - 7);
                return saleDate >= weekAgo;
              } else if (dateFilter === 'month') {
                return saleDate.getMonth() === today.getMonth() && 
                       saleDate.getFullYear() === today.getFullYear();
              } else if (dateFilter === 'custom') {
                const selected = new Date(selectedDate);
                return saleDate.toDateString() === selected.toDateString();
              }
              return true;
            });
          };

          const getTotalSales = () => {
            return getFilteredSales().reduce((sum, sale) => sum + parseFloat(sale.total), 0).toFixed(2);
          };

          const getTotalCash = () => {
            return getFilteredSales().reduce((sum, sale) => sum + parseFloat(sale.cashAmount || 0), 0).toFixed(2);
          };

          const getTotalTransfer = () => {
            return getFilteredSales().reduce((sum, sale) => sum + parseFloat(sale.transferAmount || 0), 0).toFixed(2);
          };

          const handleImageUpload = (e, field) => {
            const file = e.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onloadend = () => {
                if (field === 'product') {
                  setNewProduct({ ...newProduct, image: reader.result });
                } else if (field === 'logo') {
                  setBusinessLogo(reader.result);
                  setLogoType('image');
                }
              };
              reader.readAsDataURL(file);
            }
          };

          const exportData = () => {
            const data = {
              products,
              sales,
              businessName,
              businessLogo,
              logoType,
              categories,
              users,
              exportDate: new Date().toISOString()
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `restaurantpos_backup_${new Date().toISOString().split('T')[0]}.json`;
            a.click();
          };

          const importData = (e) => {
            const file = e.target.files[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (event) => {
                try {
                  const data = JSON.parse(event.target.result);
                  if (window.confirm('¬øEst√°s seguro de importar estos datos? Se sobrescribir√° la informaci√≥n actual.')) {
                    setProducts(data.products || []);
                    setSales(data.sales || []);
                    setBusinessName(data.businessName || 'Mi Restaurante');
                    setBusinessLogo(data.businessLogo || 'üçΩÔ∏è');
                    setLogoType(data.logoType || 'emoji');
                    if (data.categories) setCategories(data.categories);
                    if (data.users) setUsers(data.users);
                    alert('Datos importados exitosamente');
                  }
                } catch (error) {
                  alert('Error al importar los datos. Verifica que el archivo sea v√°lido.');
                }
              };
              reader.readAsText(file);
            }
          };

          if (!isLoggedIn) {
            return (
              <div className="min-h-screen bg-gradient-to-br from-orange-400 via-red-400 to-pink-500 flex items-center justify-center p-4">
                <div className="bg-white rounded-2xl shadow-2xl p-6 sm:p-8 w-full max-w-md">
                  <div className="text-center mb-6 sm:mb-8">
                    <div className="text-5xl sm:text-6xl mb-3 sm:mb-4">üçΩÔ∏è</div>
                    <h1 className="text-2xl sm:text-3xl font-bold text-gray-800 mb-2">RestaurantPOS</h1>
                    <p className="text-sm sm:text-base text-gray-600">Sistema Profesional v2.4</p>
                  </div>
                  
                  <form onSubmit={handleLogin} className="space-y-4 sm:space-y-6">
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Usuario</label>
                      <input
                        type="text"
                        value={username}
                        onChange={(e) => setUsername(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        placeholder="Ingrese usuario"
                        required
                      />
                    </div>
                    
                    <div>
                      <label className="block text-sm font-semibold text-gray-700 mb-2">Contrase√±a</label>
                      <input
                        type="password"
                        value={password}
                        onChange={(e) => setPassword(e.target.value)}
                        className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                        placeholder="Ingrese contrase√±a"
                        required
                      />
                    </div>
                    
                    <button
                      type="submit"
                      className="w-full btn-touch bg-gradient-to-r from-orange-500 to-red-500 text-white font-bold rounded-lg hover:from-orange-600 hover:to-red-600 transition-all shadow-lg"
                    >
                      Iniciar Sesi√≥n
                    </button>
                  </form>
                  
                  <div className="mt-6 pt-6 border-t border-gray-200">
                    <p className="text-xs sm:text-sm text-gray-500 text-center">
                      Usuario: <span className="font-semibold">admin</span> / Contrase√±a: <span className="font-semibold">admin</span><br/>
                      Usuario: <span className="font-semibold">cajero</span> / Contrase√±a: <span className="font-semibold">cajero</span>
                    </p>
                  </div>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gray-50">
              {/* Header responsive */}
              <header className="bg-gradient-to-r from-orange-500 to-red-500 text-white shadow-lg sticky top-0 z-50">
                <div className="container mx-auto px-3 sm:px-6 py-3 sm:py-4">
                  <div className="flex items-center justify-between gap-2 sm:gap-4">
                    <div className="logo-container">
                      {logoType === 'image' ? (
                        <img src={businessLogo} alt="Logo" className="logo-image" />
                      ) : (
                        <span className="logo-emoji text-3xl sm:text-4xl">{businessLogo}</span>
                      )}
                      <div>
                        <h1 className="text-lg sm:text-2xl font-bold truncate max-w-[150px] sm:max-w-none">{businessName}</h1>
                        <p className="text-xs sm:text-sm opacity-90 hidden sm:block">
                          {currentUser?.role === 'admin' ? 'Administrador' : 'Cajero'}: {currentUser?.name}
                        </p>
                      </div>
                    </div>
                    
                    <div className="flex items-center gap-2 sm:gap-4">
                      <div className="text-right hidden sm:block">
                        <div className="big-time time-update text-xl sm:text-2xl font-bold">
                          {formatTime(currentTime)}
                        </div>
                        <div className="text-xs opacity-90">
                          {formatDate(currentTime)}
                        </div>
                      </div>
                      
                      <button
                        onClick={handleLogout}
                        className="touch-target p-2 hover:bg-white/20 rounded-lg transition-colors"
                        title="Cerrar Sesi√≥n"
                      >
                        <LogOut size={20} />
                      </button>
                    </div>
                  </div>
                  
                  {/* Navegaci√≥n responsive - Condicional seg√∫n rol */}
                  <nav className="flex gap-1 sm:gap-2 mt-3 overflow-x-auto pb-2 -mx-3 px-3">
                    <button
                      onClick={() => setCurrentView('sales')}
                      className={`btn-touch flex items-center gap-1 sm:gap-2 whitespace-nowrap ${
                        currentView === 'sales'
                          ? 'bg-white text-orange-600 shadow-lg'
                          : 'bg-white/20 hover:bg-white/30'
                      }`}
                    >
                      <ShoppingCart size={18} />
                      <span className="text-sm sm:text-base">Ventas</span>
                    </button>
                    
                    <button
                      onClick={() => setCurrentView('reports')}
                      className={`btn-touch flex items-center gap-1 sm:gap-2 whitespace-nowrap ${
                        currentView === 'reports'
                          ? 'bg-white text-orange-600 shadow-lg'
                          : 'bg-white/20 hover:bg-white/30'
                      }`}
                    >
                      <TrendingUp size={18} />
                      <span className="text-sm sm:text-base">Reportes</span>
                    </button>
                    
                    {/* Opciones solo para administradores */}
                    {currentUser?.role === 'admin' && (
                      <>
                        <button
                          onClick={() => setCurrentView('inventory')}
                          className={`btn-touch flex items-center gap-1 sm:gap-2 whitespace-nowrap ${
                            currentView === 'inventory'
                              ? 'bg-white text-orange-600 shadow-lg'
                              : 'bg-white/20 hover:bg-white/30'
                          }`}
                        >
                          <Package size={18} />
                          <span className="text-sm sm:text-base">Inventario</span>
                        </button>
                        
                        <button
                          onClick={() => setCurrentView('settings')}
                          className={`btn-touch flex items-center gap-1 sm:gap-2 whitespace-nowrap ${
                            currentView === 'settings'
                              ? 'bg-white text-orange-600 shadow-lg'
                              : 'bg-white/20 hover:bg-white/30'
                          }`}
                        >
                          <Settings size={18} />
                          <span className="text-sm sm:text-base">Config</span>
                        </button>
                      </>
                    )}
                  </nav>
                </div>
              </header>

              {/* Contenido principal */}
              <main className="container mx-auto px-3 sm:px-6 py-4 sm:py-6">
                {/* Vista de Ventas - Accesible para todos */}
                {currentView === 'sales' && (
                  <div className="flex flex-col lg:flex-row gap-4 sm:gap-6">
                    {/* Productos */}
                    <div className="flex-1">
                      <div className="bg-white rounded-xl shadow-md p-3 sm:p-6">
                        <div className="mb-4">
                          <input
                            type="text"
                            placeholder="üîç Buscar producto..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          />
                        </div>

                        <div className="flex gap-2 mb-4 overflow-x-auto pb-2">
                          <button
                            onClick={() => setSelectedCategory('Todas')}
                            className={`btn-touch whitespace-nowrap text-sm ${
                              selectedCategory === 'Todas'
                                ? 'bg-orange-500 text-white'
                                : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                            }`}
                          >
                            Todas
                          </button>
                          {categories.map(cat => (
                            <button
                              key={cat}
                              onClick={() => setSelectedCategory(cat)}
                              className={`btn-touch whitespace-nowrap text-sm ${
                                selectedCategory === cat
                                  ? 'bg-orange-500 text-white'
                                  : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                              }`}
                            >
                              {cat}
                            </button>
                          ))}
                        </div>

                        <div className="product-grid max-h-[60vh] overflow-y-auto">
                          {filteredProducts.map(product => (
                            <div
                              key={product.id}
                              onClick={() => addToCart(product)}
                              className={`bg-white border-2 rounded-lg p-3 cursor-pointer transition-all hover:shadow-lg ${
                                product.stock === 0 
                                  ? 'border-red-300 opacity-50' 
                                  : 'border-gray-200 hover:border-orange-500'
                              }`}
                            >
                              {product.image && (
                                <img
                                  src={product.image}
                                  alt={product.name}
                                  className="w-full h-24 sm:h-32 object-cover rounded-lg mb-2"
                                />
                              )}
                              <h3 className="font-semibold text-sm sm:text-base truncate">{product.name}</h3>
                              <p className="text-orange-600 font-bold text-base sm:text-lg">${product.price}</p>
                              <p className="text-xs sm:text-sm text-gray-600">Stock: {product.stock}</p>
                            </div>
                          ))}
                        </div>
                      </div>
                    </div>

                    {/* Carrito */}
                    <div className="lg:w-96 w-full">
                      <div className="bg-white rounded-xl shadow-md p-3 sm:p-6 sticky top-20">
                        <h2 className="text-xl sm:text-2xl font-bold mb-4 flex items-center gap-2">
                          <ShoppingCart size={24} />
                          Carrito ({cart.length})
                        </h2>

                        <div className="space-y-2 mb-4 max-h-[40vh] overflow-y-auto">
                          {cart.map(item => (
                            <div key={item.id} className="flex items-center gap-2 p-2 bg-gray-50 rounded-lg">
                              <div className="flex-1 min-w-0">
                                <p className="font-semibold text-sm truncate">{item.name}</p>
                                <p className="text-xs sm:text-sm text-gray-600">${item.price} c/u</p>
                              </div>
                              <div className="flex items-center gap-1 sm:gap-2">
                                <button
                                  onClick={() => updateQuantity(item.id, -1)}
                                  className="touch-target p-1 bg-orange-100 text-orange-600 rounded hover:bg-orange-200"
                                >
                                  <Minus size={16} />
                                </button>
                                <span className="w-8 text-center font-bold text-sm">{item.quantity}</span>
                                <button
                                  onClick={() => updateQuantity(item.id, 1)}
                                  className="touch-target p-1 bg-orange-100 text-orange-600 rounded hover:bg-orange-200"
                                >
                                  <Plus size={16} />
                                </button>
                                <button
                                  onClick={() => removeFromCart(item.id)}
                                  className="touch-target p-1 bg-red-100 text-red-600 rounded hover:bg-red-200 ml-1"
                                >
                                  <Trash size={16} />
                                </button>
                              </div>
                            </div>
                          ))}
                        </div>

                        <div className="border-t-2 pt-4 space-y-2">
                          <div className="flex justify-between items-center">
                            <span className="text-lg sm:text-xl font-bold">Total:</span>
                            <span className="text-2xl sm:text-3xl font-bold text-orange-600">${getTotal()}</span>
                          </div>
                          
                          <button
                            onClick={() => setShowPaymentModal(true)}
                            disabled={cart.length === 0}
                            className="w-full btn-touch bg-gradient-to-r from-green-500 to-green-600 text-white font-bold disabled:opacity-50 disabled:cursor-not-allowed hover:from-green-600 hover:to-green-700 transition-all shadow-lg"
                          >
                            Procesar Pago
                          </button>
                          
                          {cart.length > 0 && (
                            <button
                              onClick={() => setCart([])}
                              className="w-full btn-touch bg-gray-200 text-gray-700 font-semibold hover:bg-gray-300 transition-colors"
                            >
                              Limpiar Carrito
                            </button>
                          )}
                        </div>
                      </div>
                    </div>
                  </div>
                )}

                {/* Vista de Inventario - Solo admin */}
                {currentView === 'inventory' && currentUser?.role === 'admin' && (
                  <div className="bg-white rounded-xl shadow-md p-3 sm:p-6">
                    <div className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 mb-6">
                      <h2 className="text-xl sm:text-2xl font-bold flex items-center gap-2">
                        <Package size={24} />
                        Inventario de Productos
                      </h2>
                      <button
                        onClick={() => setShowAddProduct(true)}
                        className="btn-touch bg-orange-500 text-white font-semibold hover:bg-orange-600 transition-colors shadow-lg flex items-center gap-2 w-full sm:w-auto justify-center"
                      >
                        <Plus size={20} />
                        Agregar Producto
                      </button>
                    </div>

                    <div className="overflow-x-auto">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Producto</th>
                            <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase hidden sm:table-cell">Categor√≠a</th>
                            <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Precio</th>
                            <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Stock</th>
                            <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Acciones</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-200">
                          {products.map(product => (
                            <tr key={product.id} className="hover:bg-gray-50">
                              <td className="px-3 sm:px-6 py-4">
                                <div className="flex items-center gap-2 sm:gap-3">
                                  {product.image && (
                                    <img
                                      src={product.image}
                                      alt={product.name}
                                      className="w-10 h-10 sm:w-12 sm:h-12 object-cover rounded"
                                    />
                                  )}
                                  <div>
                                    <div className="font-semibold text-sm sm:text-base">{product.name}</div>
                                    <div className="text-xs text-gray-500 sm:hidden">{product.category}</div>
                                  </div>
                                </div>
                              </td>
                              <td className="px-3 sm:px-6 py-4 hidden sm:table-cell">
                                <span className="px-2 py-1 text-xs font-semibold rounded-full bg-orange-100 text-orange-600">
                                  {product.category}
                                </span>
                              </td>
                              <td className="px-3 sm:px-6 py-4 font-bold text-orange-600 text-sm sm:text-base">${product.price}</td>
                              <td className="px-3 sm:px-6 py-4">
                                <span className={`px-2 py-1 text-xs sm:text-sm font-semibold rounded-full ${
                                  product.stock === 0
                                    ? 'bg-red-100 text-red-600'
                                    : product.stock < 10
                                    ? 'bg-yellow-100 text-yellow-600'
                                    : 'bg-green-100 text-green-600'
                                }`}>
                                  {product.stock}
                                </span>
                              </td>
                              <td className="px-3 sm:px-6 py-4">
                                <div className="flex gap-1 sm:gap-2">
                                  <button
                                    onClick={() => editProduct(product)}
                                    className="touch-target p-1.5 sm:p-2 bg-blue-100 text-blue-600 rounded hover:bg-blue-200"
                                  >
                                    <Edit size={16} />
                                  </button>
                                  <button
                                    onClick={() => deleteProduct(product.id)}
                                    className="touch-target p-1.5 sm:p-2 bg-red-100 text-red-600 rounded hover:bg-red-200"
                                  >
                                    <Trash size={16} />
                                  </button>
                                </div>
                              </td>
                            </tr>
                          ))}
                        </tbody>
                      </table>
                    </div>

                    {products.length === 0 && (
                      <div className="text-center py-12">
                        <Package size={64} className="mx-auto text-gray-300 mb-4" />
                        <p className="text-gray-500 text-lg">No hay productos en el inventario</p>
                        <p className="text-gray-400">Agrega tu primer producto para comenzar</p>
                      </div>
                    )}
                  </div>
                )}

                {/* Vista de Reportes - Accesible para todos */}
                {currentView === 'reports' && (
                  <div className="space-y-4 sm:space-y-6">
                    <div className="bg-white rounded-xl shadow-md p-3 sm:p-6">
                      <h2 className="text-xl sm:text-2xl font-bold mb-4 flex items-center gap-2">
                        <TrendingUp size={24} />
                        Reportes de Ventas
                      </h2>

                      <div className="flex flex-col sm:flex-row gap-2 sm:gap-4 mb-6">
                        <button
                          onClick={() => setDateFilter('today')}
                          className={`btn-touch text-sm ${
                            dateFilter === 'today'
                              ? 'bg-orange-500 text-white'
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          Hoy
                        </button>
                        <button
                          onClick={() => setDateFilter('week')}
                          className={`btn-touch text-sm ${
                            dateFilter === 'week'
                              ? 'bg-orange-500 text-white'
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          Esta Semana
                        </button>
                        <button
                          onClick={() => setDateFilter('month')}
                          className={`btn-touch text-sm ${
                            dateFilter === 'month'
                              ? 'bg-orange-500 text-white'
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          Este Mes
                        </button>
                        <button
                          onClick={() => setDateFilter('all')}
                          className={`btn-touch text-sm ${
                            dateFilter === 'all'
                              ? 'bg-orange-500 text-white'
                              : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                          }`}
                        >
                          Todo
                        </button>
                        <div className="flex gap-2 flex-1">
                          <input
                            type="date"
                            value={selectedDate}
                            onChange={(e) => {
                              setSelectedDate(e.target.value);
                              setDateFilter('custom');
                            }}
                            className="flex-1 px-3 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 text-sm"
                          />
                        </div>
                      </div>

                      <div className="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-6 mb-6">
                        <div className="bg-gradient-to-br from-green-50 to-green-100 p-4 sm:p-6 rounded-xl border-2 border-green-200">
                          <div className="flex items-center gap-2 mb-2">
                            <DollarSign className="text-green-600" size={20} />
                            <p className="text-xs sm:text-sm font-semibold text-green-700">Ventas Totales</p>
                          </div>
                          <p className="text-2xl sm:text-3xl font-bold text-green-600">${getTotalSales()}</p>
                          <p className="text-xs text-green-600 mt-1">{getFilteredSales().length} ventas</p>
                        </div>

                        <div className="bg-gradient-to-br from-blue-50 to-blue-100 p-4 sm:p-6 rounded-xl border-2 border-blue-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-lg sm:text-xl">üíµ</span>
                            <p className="text-xs sm:text-sm font-semibold text-blue-700">Efectivo</p>
                          </div>
                          <p className="text-2xl sm:text-3xl font-bold text-blue-600">${getTotalCash()}</p>
                        </div>

                        <div className="bg-gradient-to-br from-purple-50 to-purple-100 p-4 sm:p-6 rounded-xl border-2 border-purple-200">
                          <div className="flex items-center gap-2 mb-2">
                            <span className="text-lg sm:text-xl">üè¶</span>
                            <p className="text-xs sm:text-sm font-semibold text-purple-700">Transferencias</p>
                          </div>
                          <p className="text-2xl sm:text-3xl font-bold text-purple-600">${getTotalTransfer()}</p>
                        </div>
                      </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-md p-3 sm:p-6">
                      <h3 className="text-lg sm:text-xl font-bold mb-4">Historial de Ventas</h3>
                      <div className="overflow-x-auto">
                        <table className="w-full">
                          <thead className="bg-gray-50">
                            <tr>
                              <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Fecha/Hora</th>
                              <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Cajero</th>
                              <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase hidden sm:table-cell">Items</th>
                              <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Total</th>
                              <th className="px-3 sm:px-6 py-3 text-left text-xs font-semibold text-gray-700 uppercase hidden md:table-cell">Pago</th>
                            </tr>
                          </thead>
                          <tbody className="divide-y divide-gray-200">
                            {getFilteredSales().reverse().map(sale => (
                              <tr key={sale.id} className="hover:bg-gray-50">
                                <td className="px-3 sm:px-6 py-4">
                                  <div className="text-xs sm:text-sm">
                                    <div className="font-semibold">{new Date(sale.date).toLocaleDateString('es-ES')}</div>
                                    <div className="text-gray-500">{sale.time}</div>
                                  </div>
                                </td>
                                <td className="px-3 sm:px-6 py-4">
                                  <div className="text-xs sm:text-sm text-gray-600">{sale.cashier || 'Cajero'}</div>
                                </td>
                                <td className="px-3 sm:px-6 py-4 hidden sm:table-cell">
                                  <div className="text-xs sm:text-sm text-gray-600">{sale.items.length} items</div>
                                </td>
                                <td className="px-3 sm:px-6 py-4 font-bold text-green-600 text-sm sm:text-base">${sale.total}</td>
                                <td className="px-3 sm:px-6 py-4 hidden md:table-cell">
                                  <span className="px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-600">
                                    {sale.paymentMethod === 'cash' ? 'üíµ Efectivo' :
                                     sale.paymentMethod === 'transfer' ? 'üè¶ Transfer.' :
                                     'üí≥ Mixto'}
                                  </span>
                                </td>
                              </tr>
                            ))}
                          </tbody>
                        </table>
                      </div>

                      {getFilteredSales().length === 0 && (
                        <div className="text-center py-12">
                          <TrendingUp size={64} className="mx-auto text-gray-300 mb-4" />
                          <p className="text-gray-500 text-lg">No hay ventas para mostrar</p>
                        </div>
                      )}
                    </div>
                  </div>
                )}

                {/* Vista de Configuraci√≥n - Solo admin */}
                {currentView === 'settings' && currentUser?.role === 'admin' && (
                  <div className="space-y-6">
                    <div className="max-w-2xl mx-auto">
                      <div className="bg-white rounded-xl shadow-md p-4 sm:p-6">
                        <h2 className="text-xl sm:text-2xl font-bold mb-6 flex items-center gap-2">
                          <Settings size={24} />
                          Configuraci√≥n del Negocio
                        </h2>

                        <div className="space-y-6">
                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Nombre del Negocio</label>
                            <input
                              type="text"
                              value={businessName}
                              onChange={(e) => setBusinessName(e.target.value)}
                              className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                              placeholder="Mi Restaurante"
                            />
                          </div>

                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Logo del Negocio</label>
                            <div className="flex flex-col sm:flex-row gap-4">
                              <div className="flex gap-2">
                                <button
                                  onClick={() => setLogoType('emoji')}
                                  className={`btn-touch ${
                                    logoType === 'emoji'
                                      ? 'bg-orange-500 text-white'
                                      : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                  }`}
                                >
                                  Emoji
                                </button>
                                <button
                                  onClick={() => setLogoType('image')}
                                  className={`btn-touch ${
                                    logoType === 'image'
                                      ? 'bg-orange-500 text-white'
                                      : 'bg-gray-200 text-gray-700 hover:bg-gray-300'
                                  }`}
                                >
                                  Imagen
                                </button>
                              </div>
                            </div>

                            {logoType === 'emoji' && (
                              <div className="mt-4">
                                <button
                                  onClick={() => setShowEmojiPicker(!showEmojiPicker)}
                                  className="btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 flex items-center gap-2"
                                >
                                  <span className="text-2xl">{businessLogo}</span>
                                  <span>Cambiar Emoji</span>
                                </button>

                                {showEmojiPicker && (
                                  <div className="mt-4 p-4 bg-gray-50 rounded-lg max-h-64 overflow-y-auto">
                                    <div className="emoji-grid">
                                      {emojis.map(emoji => (
                                        <button
                                          key={emoji}
                                          onClick={() => {
                                            setBusinessLogo(emoji);
                                            setShowEmojiPicker(false);
                                          }}
                                          className={`emoji-button ${businessLogo === emoji ? 'selected' : ''}`}
                                        >
                                          {emoji}
                                        </button>
                                      ))}
                                    </div>
                                  </div>
                                )}
                              </div>
                            )}

                            {logoType === 'image' && (
                              <div className="mt-4">
                                <input
                                  type="file"
                                  accept="image/*"
                                  onChange={(e) => handleImageUpload(e, 'logo')}
                                  className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"
                                />
                                {businessLogo && businessLogo.startsWith('data:') && (
                                  <img
                                    src={businessLogo}
                                    alt="Logo"
                                    className="mt-4 max-h-32 rounded-lg border-2 border-gray-200"
                                  />
                                )}
                              </div>
                            )}
                          </div>

                          <div className="pt-6 border-t-2">
                            <h3 className="text-lg font-bold mb-4">Gesti√≥n de Datos</h3>
                            <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                              <button
                                onClick={exportData}
                                className="btn-touch bg-blue-500 text-white hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"
                              >
                                <Download size={20} />
                                Exportar Datos
                              </button>
                              
                              <label className="btn-touch bg-green-500 text-white hover:bg-green-600 transition-colors cursor-pointer flex items-center justify-center gap-2">
                                <Upload size={20} />
                                Importar Datos
                                <input
                                  type="file"
                                  accept=".json"
                                  onChange={importData}
                                  className="hidden"
                                />
                              </label>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Gesti√≥n de Categor√≠as */}
                    <div className="max-w-2xl mx-auto">
                      <div className="bg-white rounded-xl shadow-md p-4 sm:p-6">
                        <h3 className="text-xl sm:text-2xl font-bold mb-6 flex items-center gap-2">
                          <Tag size={24} />
                          Gesti√≥n de Categor√≠as
                        </h3>

                        <div className="space-y-4">
                          <button
                            onClick={() => {
                              setEditingCategory(null);
                              setNewCategory('');
                              setShowCategoryManagement(true);
                            }}
                            className="btn-touch bg-orange-500 text-white font-semibold hover:bg-orange-600 transition-colors shadow-lg flex items-center gap-2 w-full justify-center"
                          >
                            <Plus size={20} />
                            Agregar Categor√≠a
                          </button>

                          <div className="grid grid-cols-1 sm:grid-cols-2 gap-3">
                            {categories.map(category => (
                              <div key={category} className="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                <span className="font-semibold">{category}</span>
                                <div className="flex gap-2">
                                  <button
                                    onClick={() => editCategory(category)}
                                    className="touch-target p-2 bg-blue-100 text-blue-600 rounded hover:bg-blue-200"
                                  >
                                    <Edit size={16} />
                                  </button>
                                  {category !== 'Comida' && category !== 'Bebida' && 
                                   category !== 'Postre' && category !== 'Entrada' && (
                                    <button
                                      onClick={() => deleteCategory(category)}
                                      className="touch-target p-2 bg-red-100 text-red-600 rounded hover:bg-red-200"
                                    >
                                      <Trash size={16} />
                                    </button>
                                  )}
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      </div>
                    </div>

                    {/* Gesti√≥n de Usuarios */}
                    <div className="max-w-2xl mx-auto">
                      <div className="bg-white rounded-xl shadow-md p-4 sm:p-6">
                        <h3 className="text-xl sm:text-2xl font-bold mb-6 flex items-center gap-2">
                          <Users size={24} />
                          Gesti√≥n de Usuarios
                        </h3>

                        <div className="space-y-4">
                          <button
                            onClick={() => {
                              setEditingUser(null);
                              setNewUser({
                                username: '',
                                password: '',
                                role: 'cashier',
                                name: ''
                              });
                              setShowUserManagement(true);
                            }}
                            className="btn-touch bg-orange-500 text-white font-semibold hover:bg-orange-600 transition-colors shadow-lg flex items-center gap-2 w-full justify-center"
                          >
                            <Plus size={20} />
                            Agregar Usuario
                          </button>

                          <div className="overflow-x-auto">
                            <table className="w-full">
                              <thead className="bg-gray-50">
                                <tr>
                                  <th className="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Usuario</th>
                                  <th className="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Nombre</th>
                                  <th className="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Rol</th>
                                  <th className="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase">Acciones</th>
                                </tr>
                              </thead>
                              <tbody className="divide-y divide-gray-200">
                                {users.map(user => (
                                  <tr key={user.id} className="hover:bg-gray-50">
                                    <td className="px-4 py-4 font-medium">{user.username}</td>
                                    <td className="px-4 py-4">{user.name}</td>
                                    <td className="px-4 py-4">
                                      <span className={`px-2 py-1 text-xs font-semibold rounded-full ${
                                        user.role === 'admin'
                                          ? 'bg-purple-100 text-purple-600'
                                          : 'bg-green-100 text-green-600'
                                      }`}>
                                        {user.role === 'admin' ? 'Administrador' : 'Cajero'}
                                      </span>
                                    </td>
                                    <td className="px-4 py-4">
                                      <div className="flex gap-2">
                                        <button
                                          onClick={() => editUser(user)}
                                          className="touch-target p-2 bg-blue-100 text-blue-600 rounded hover:bg-blue-200"
                                        >
                                          <Edit size={16} />
                                        </button>
                                        {user.id !== currentUser?.id && (
                                          <button
                                            onClick={() => deleteUser(user.id)}
                                            className="touch-target p-2 bg-red-100 text-red-600 rounded hover:bg-red-200"
                                          >
                                            <Trash size={16} />
                                          </button>
                                        )}
                                      </div>
                                    </td>
                                  </tr>
                                ))}
                              </tbody>
                            </table>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </main>

              {/* Modal Agregar/Editar Producto */}
              {showAddProduct && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg modal-content">
                    <div className="p-4 sm:p-6">
                      <h3 className="text-xl sm:text-2xl font-bold mb-4">
                        {editingProduct ? 'Editar Producto' : 'Agregar Producto'}
                      </h3>

                      <form onSubmit={addProduct} className="space-y-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Nombre *</label>
                          <input
                            type="text"
                            value={newProduct.name}
                            onChange={(e) => setNewProduct({ ...newProduct, name: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                            required
                          />
                        </div>

                        <div className="grid grid-cols-2 gap-4">
                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Precio *</label>
                            <input
                              type="number"
                              step="0.01"
                              value={newProduct.price}
                              onChange={(e) => setNewProduct({ ...newProduct, price: e.target.value })}
                              className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                              required
                            />
                          </div>

                          <div>
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Stock *</label>
                            <input
                              type="number"
                              value={newProduct.stock}
                              onChange={(e) => setNewProduct({ ...newProduct, stock: e.target.value })}
                              className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                              required
                            />
                          </div>
                        </div>

                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Categor√≠a *</label>
                          <select
                            value={newProduct.category}
                            onChange={(e) => setNewProduct({ ...newProduct, category: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          >
                            {categories.map(cat => (
                              <option key={cat} value={cat}>{cat}</option>
                            ))}
                          </select>
                        </div>

                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Imagen</label>
                          <input
                            type="file"
                            accept="image/*"
                            onChange={(e) => handleImageUpload(e, 'product')}
                            className="w-full px-4 py-2 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500"
                          />
                          {newProduct.image && (
                            <img
                              src={newProduct.image}
                              alt="Preview"
                              className="mt-2 w-full h-32 object-cover rounded-lg"
                            />
                          )}
                        </div>

                        <div className="flex gap-3 pt-4">
                          <button
                            type="button"
                            onClick={() => {
                              setShowAddProduct(false);
                              setEditingProduct(null);
                              setNewProduct({
                                name: '',
                                price: '',
                                category: 'Comida',
                                stock: '',
                                image: '',
                                description: ''
                              });
                            }}
                            className="flex-1 btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                          >
                            Cancelar
                          </button>
                          <button
                            type="submit"
                            className="flex-1 btn-touch bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg"
                          >
                            {editingProduct ? 'Actualizar' : 'Agregar'}
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              )}

              {/* Modal Gesti√≥n de Usuarios */}
              {showUserManagement && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg modal-content">
                    <div className="p-4 sm:p-6">
                      <h3 className="text-xl sm:text-2xl font-bold mb-4">
                        {editingUser ? 'Editar Usuario' : 'Agregar Usuario'}
                      </h3>

                      <form onSubmit={addUser} className="space-y-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Nombre Completo *</label>
                          <input
                            type="text"
                            value={newUser.name}
                            onChange={(e) => setNewUser({ ...newUser, name: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                            required
                          />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Usuario *</label>
                          <input
                            type="text"
                            value={newUser.username}
                            onChange={(e) => setNewUser({ ...newUser, username: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                            required
                          />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">
                            {editingUser ? 'Contrase√±a (dejar vac√≠o para no cambiar)' : 'Contrase√±a *'}
                          </label>
                          <input
                            type="password"
                            value={newUser.password}
                            onChange={(e) => setNewUser({ ...newUser, password: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                            required={!editingUser}
                          />
                        </div>

                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Rol *</label>
                          <select
                            value={newUser.role}
                            onChange={(e) => setNewUser({ ...newUser, role: e.target.value })}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                          >
                            <option value="admin">Administrador</option>
                            <option value="cashier">Cajero</option>
                          </select>
                          <p className="text-xs text-gray-500 mt-1">
                            Administrador: acceso completo | Cajero: solo ventas y reportes
                          </p>
                        </div>

                        <div className="flex gap-3 pt-4">
                          <button
                            type="button"
                            onClick={() => {
                              setShowUserManagement(false);
                              setEditingUser(null);
                              setNewUser({
                                username: '',
                                password: '',
                                role: 'cashier',
                                name: ''
                              });
                            }}
                            className="flex-1 btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                          >
                            Cancelar
                          </button>
                          <button
                            type="submit"
                            className="flex-1 btn-touch bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg"
                          >
                            {editingUser ? 'Actualizar' : 'Agregar'}
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              )}

              {/* Modal Gesti√≥n de Categor√≠as */}
              {showCategoryManagement && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg modal-content">
                    <div className="p-4 sm:p-6">
                      <h3 className="text-xl sm:text-2xl font-bold mb-4">
                        {editingCategory ? 'Editar Categor√≠a' : 'Agregar Categor√≠a'}
                      </h3>

                      <form onSubmit={addCategory} className="space-y-4">
                        <div>
                          <label className="block text-sm font-semibold text-gray-700 mb-2">Nombre de la Categor√≠a *</label>
                          <input
                            type="text"
                            value={newCategory}
                            onChange={(e) => setNewCategory(e.target.value)}
                            className="w-full px-4 py-2 sm:py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"
                            placeholder="Ej: Ensaladas, Sopas, etc."
                            required
                            autoFocus
                          />
                        </div>

                        <div className="flex gap-3 pt-4">
                          <button
                            type="button"
                            onClick={() => {
                              setShowCategoryManagement(false);
                              setEditingCategory(null);
                              setNewCategory('');
                            }}
                            className="flex-1 btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                          >
                            Cancelar
                          </button>
                          <button
                            type="submit"
                            className="flex-1 btn-touch bg-orange-500 text-white hover:bg-orange-600 transition-colors shadow-lg"
                          >
                            {editingCategory ? 'Actualizar' : 'Agregar'}
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              )}

              {/* Modal de Pago */}
              {showPaymentModal && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-xl shadow-2xl w-full max-w-lg modal-content">
                    <div className="p-4 sm:p-6">
                      <h3 className="text-xl sm:text-2xl font-bold mb-4">Procesar Pago</h3>

                      <div className="mb-4 sm:mb-6 p-4 bg-orange-50 rounded-lg">
                        <div className="text-sm font-semibold text-orange-700 mb-2">Total a Pagar</div>
                        <div className="text-3xl sm:text-4xl font-bold text-orange-600">${getTotal()}</div>
                      </div>

                      <form onSubmit={processSale}>
                        <div className="mb-4 sm:mb-6">
                          <label className="block text-sm font-semibold text-gray-700 mb-3">M√©todo de Pago</label>
                          <div className="grid grid-cols-3 gap-2">
                            <button
                              type="button"
                              onClick={() => {
                                setPaymentMethod('cash');
                                setCashAmount('');
                                setTransferAmount('');
                              }}
                              className={`btn-touch transition-all ${
                                paymentMethod === 'cash'
                                  ? 'bg-green-500 text-white shadow-lg scale-105'
                                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                              }`}
                            >
                              üíµ Efectivo
                            </button>
                            <button
                              type="button"
                              onClick={() => {
                                setPaymentMethod('transfer');
                                setCashAmount('');
                                setTransferAmount('');
                              }}
                              className={`btn-touch transition-all ${
                                paymentMethod === 'transfer'
                                  ? 'bg-blue-500 text-white shadow-lg scale-105'
                                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                              }`}
                            >
                              üè¶ Transfer.
                            </button>
                            <button
                              type="button"
                              onClick={() => {
                                setPaymentMethod('mixed');
                                setCashAmount('');
                                setTransferAmount('');
                              }}
                              className={`btn-touch transition-all ${
                                paymentMethod === 'mixed'
                                  ? 'bg-purple-500 text-white shadow-lg scale-105'
                                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                              }`}
                            >
                              üí≥ Mixto
                            </button>
                          </div>
                        </div>

                        {paymentMethod === 'cash' && (
                          <div className="mb-4 sm:mb-6">
                            <label className="block text-sm font-semibold text-gray-700 mb-2">Monto Recibido *</label>
                            <input
                              type="number"
                              step="0.01"
                              value={cashAmount}
                              onChange={(e) => setCashAmount(e.target.value)}
                              className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent text-lg"
                              placeholder="0.00"
                              required
                              autoFocus
                            />
                            {cashAmount && parseFloat(cashAmount) >= parseFloat(getTotal()) && (
                              <div className="mt-3 p-3 bg-green-50 rounded-lg">
                                <div className="text-sm text-green-700 font-semibold">Cambio a Devolver</div>
                                <div className="text-2xl font-bold text-green-600">
                                  ${(parseFloat(cashAmount) - parseFloat(getTotal())).toFixed(2)}
                                </div>
                              </div>
                            )}
                          </div>
                        )}

                        {paymentMethod === 'transfer' && (
                          <div className="mb-4 sm:mb-6 p-4 bg-blue-50 rounded-lg text-center">
                            <div className="text-blue-700 font-semibold mb-2">Monto a Transferir</div>
                            <div className="text-2xl sm:text-3xl font-bold text-blue-600">${getTotal()}</div>
                            <div className="text-sm text-blue-600 mt-2">Confirme que recibi√≥ la transferencia</div>
                          </div>
                        )}

                        {paymentMethod === 'mixed' && (
                          <div className="mb-4 sm:mb-6 space-y-4">
                            <div>
                              <label className="block text-sm font-semibold text-gray-700 mb-2">Efectivo *</label>
                              <input
                                type="number"
                                step="0.01"
                                value={cashAmount}
                                onChange={(e) => {
                                  setCashAmount(e.target.value);
                                  const remaining = parseFloat(getTotal()) - parseFloat(e.target.value || 0);
                                  setTransferAmount(remaining > 0 ? remaining.toFixed(2) : '0.00');
                                }}
                                className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-lg"
                                placeholder="0.00"
                                required
                                autoFocus
                              />
                            </div>
                            <div>
                              <label className="block text-sm font-semibold text-gray-700 mb-2">Transferencia *</label>
                              <input
                                type="number"
                                step="0.01"
                                value={transferAmount}
                                onChange={(e) => {
                                  setTransferAmount(e.target.value);
                                  const remaining = parseFloat(getTotal()) - parseFloat(e.target.value || 0);
                                  setCashAmount(remaining > 0 ? remaining.toFixed(2) : '0.00');
                                }}
                                className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-lg"
                                placeholder="0.00"
                                required
                              />
                            </div>
                            {cashAmount && transferAmount && (
                              <div className="p-3 bg-purple-50 rounded-lg">
                                <div className="flex justify-between text-sm mb-1">
                                  <span className="text-purple-700">Total Pagado:</span>
                                  <span className="font-bold text-purple-900">
                                    ${(parseFloat(cashAmount || 0) + parseFloat(transferAmount || 0)).toFixed(2)}
                                  </span>
                                </div>
                                <div className="flex justify-between text-sm">
                                  <span className="text-purple-700">Total Venta:</span>
                                  <span className="font-bold text-purple-900">${getTotal()}</span>
                                </div>
                              </div>
                            )}
                          </div>
                        )}

                        <div className="flex gap-3">
                          <button
                            type="button"
                            onClick={() => {
                              setShowPaymentModal(false);
                              setPaymentMethod('cash');
                              setCashAmount('');
                              setTransferAmount('');
                            }}
                            className="flex-1 btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                          >
                            Cancelar
                          </button>
                          <button
                            type="submit"
                            className="flex-1 btn-touch bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700 transition-colors shadow-lg"
                          >
                            Confirmar Pago
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              )}

              {/* Recibo t√©rmico */}
              {showReceipt && lastSale && (
                <div className="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50">
                  <div className="bg-white rounded-xl shadow-2xl w-full max-w-md modal-content">
                    <div className="p-4 sm:p-6 no-print">
                      <div className="flex justify-between items-center mb-4">
                        <h3 className="text-xl font-bold">Venta Completada</h3>
                        <button
                          onClick={() => setShowReceipt(false)}
                          className="touch-target p-2 hover:bg-gray-100 rounded-lg transition-colors"
                        >
                          <X size={24} />
                        </button>
                      </div>

                      <div className="thermal-receipt border-2 border-gray-200 rounded-lg mb-4">
                        <div className="text-center mb-4">
                          {logoType === 'image' ? (
                            <img src={businessLogo} alt="Logo" className="mx-auto mb-2 max-h-16" />
                          ) : (
                            <div className="text-4xl mb-2">{businessLogo}</div>
                          )}
                          <div className="font-bold text-lg">{businessName}</div>
                          <div className="text-sm">{new Date(lastSale.date).toLocaleString('es-ES')}</div>
                          <div className="text-sm font-semibold mt-1">Cajero: {lastSale.cashier || currentUser?.name}</div>
                        </div>

                        <div className="border-t-2 border-dashed border-gray-300 my-3"></div>

                        {lastSale.items.map((item, index) => (
                          <div key={index} className="mb-2">
                            <div className="flex justify-between">
                              <span>{item.name}</span>
                            </div>
                            <div className="flex justify-between text-sm">
                              <span>{item.quantity} x ${item.price}</span>
                              <span className="font-bold">${(item.quantity * item.price).toFixed(2)}</span>
                            </div>
                          </div>
                        ))}

                        <div className="border-t-2 border-dashed border-gray-300 my-3"></div>

                        <div className="flex justify-between font-bold text-lg mb-2">
                          <span>TOTAL:</span>
                          <span>${lastSale.total}</span>
                        </div>

                        <div className="text-sm space-y-1">
                          <div className="flex justify-between">
                            <span>M√©todo de Pago:</span>
                            <span className="font-semibold">
                              {lastSale.paymentMethod === 'cash' ? 'Efectivo' :
                               lastSale.paymentMethod === 'transfer' ? 'Transferencia' :
                               'Mixto'}
                            </span>
                          </div>
                          {lastSale.cashAmount > 0 && (
                            <div className="flex justify-between">
                              <span>Efectivo:</span>
                              <span>${lastSale.cashAmount.toFixed(2)}</span>
                            </div>
                          )}
                          {lastSale.transferAmount > 0 && (
                            <div className="flex justify-between">
                              <span>Transferencia:</span>
                              <span>${lastSale.transferAmount.toFixed(2)}</span>
                            </div>
                          )}
                          {lastSale.change > 0 && (
                            <div className="flex justify-between font-semibold">
                              <span>Cambio:</span>
                              <span>${lastSale.change}</span>
                            </div>
                          )}
                        </div>

                        <div className="border-t-2 border-dashed border-gray-300 my-3"></div>
                        <div className="text-center text-sm">
                          ¬°Gracias por su compra!
                        </div>
                      </div>

                      <div className="flex gap-3">
                        <button
                          onClick={printReceipt}
                          className="flex-1 btn-touch bg-blue-500 text-white hover:bg-blue-600 transition-colors flex items-center justify-center gap-2"
                        >
                          <Printer size={20} />
                          Imprimir
                        </button>
                        <button
                          onClick={() => setShowReceipt(false)}
                          className="flex-1 btn-touch bg-gray-200 text-gray-700 hover:bg-gray-300 transition-colors"
                        >
                          Cerrar
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              )}
            </div>
          );
        };

        // Renderizar la aplicaci√≥n
        ReactDOM.render(<RestaurantApp />, document.getElementById('root'));
    </script>
</body>
</html>